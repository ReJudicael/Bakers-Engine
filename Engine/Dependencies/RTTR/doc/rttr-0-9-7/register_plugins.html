<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.17"/>
        <script type="text/javascript" src="jquery.min.js"></script>
        <title>rttr: Register Plugins</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link rel = "shortcut icon" type = "image/x-icon" href = "favicon.ico">
        <link rel = "stylesheet" href = "fonts/ptsans_regular_macroman/stylesheet.css">
        <link rel = "stylesheet" href = "fonts/source_code_pro_regular/stylesheet.css">
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="custom-doxygen.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="custom-bootstrap.css">
        <script src="bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
     <!--
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">rttr 0.9.7</a>
                </div>
            </div>
        </nav>
        -->
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Register Plugins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>RTTR has build in support to register your types into shared libraries, which can be loaded and unloaded at runtime. Furthermore, it has a simple wrapper class called <a class="el" href="classrttr_1_1library.html">library</a> which wraps the platform dependent calls to load the library.</p>
<p>See following example: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;rttr/registration&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>MyPluginClass</div>
<div class="line">{</div>
<div class="line">    MyPluginClass(){}</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> perform_calculation()</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacerttr.html#a54ecd8bad715cbc451e7aa8491667d4a">value</a> += 12;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> perform_calculation(<span class="keywordtype">int</span> new_value)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacerttr.html#a54ecd8bad715cbc451e7aa8491667d4a">value</a> += new_value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="namespacerttr.html#a54ecd8bad715cbc451e7aa8491667d4a">value</a> = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code" href="registration_8h.html#acd4d632edb955a7664489ae6d90aa8bd">RTTR_PLUGIN_REGISTRATION</a> <span class="comment">// remark the different registration macro!</span></div>
<div class="line">{</div>
<div class="line">   <a class="code" href="classrttr_1_1registration_1_1class__.html">rttr::registration::class_&lt;MyPluginClass&gt;</a>(<span class="stringliteral">&quot;MyPluginClass&quot;</span>)</div>
<div class="line">        .<a class="code" href="classrttr_1_1registration_1_1class__.html#a0c0f9b9b4a78e8eefb17f690f15e7795">constructor</a>&lt;&gt;()</div>
<div class="line">        .property(<span class="stringliteral">&quot;value&quot;</span>, &amp;<a class="code" href="namespacerttr.html#a54ecd8bad715cbc451e7aa8491667d4a">MyPluginClass::value</a>)</div>
<div class="line">        .method(<span class="stringliteral">&quot;perform_calculation&quot;</span>, <a class="code" href="namespacerttr.html#a1582d7d5b803f7dd5498a4a0166d382d">rttr::select_overload</a>&lt;<span class="keywordtype">void</span>(<span class="keywordtype">void</span>)&gt;(&amp;MyPluginClass::perform_calculation))</div>
<div class="line">        .method(<span class="stringliteral">&quot;perform_calculation&quot;</span>, <a class="code" href="namespacerttr.html#a1582d7d5b803f7dd5498a4a0166d382d">rttr::select_overload</a>&lt;<span class="keywordtype">void</span>(<span class="keywordtype">int</span>)&gt;(&amp;MyPluginClass::perform_calculation))</div>
<div class="line">        ;</div>
<div class="line">}</div>
</div><!-- fragment --><p>In order to register your types inside a plugin, you have to use the macro <a class="el" href="registration_8h.html#acd4d632edb955a7664489ae6d90aa8bd">RTTR_PLUGIN_REGISTRATION</a>. Then the containing code will be executed every time you load the library and it makes sure to unregister yours types, when your library will be unloaded.</p>
<p>Now the following code will load the plugin into your application: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;rttr/type&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using namespace </span><a class="code" href="namespacerttr.html">rttr</a>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// no suffix is needed, RTTR will automatically append the platform specific file suffix</span></div>
<div class="line">    <a class="code" href="classrttr_1_1library.html">library</a> lib(<span class="stringliteral">&quot;MyPlugin&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!lib.load())</div>
<div class="line">    {</div>
<div class="line">        std::cerr &lt;&lt; lib.get_error_string() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// print all classes contained in the library</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> t : lib.get_types()) <span class="comment">// returns all registered types from this library</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (t.is_class() &amp;&amp; !t.is_wrapper())</div>
<div class="line">            std::cout &lt;&lt; t.get_name() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// we cannot use the actual type, to get the type information,</span></div>
<div class="line">    <span class="comment">// thus we use string to retrieve it</span></div>
<div class="line">    <span class="keyword">auto</span> t = <a class="code" href="classrttr_1_1type.html#a7ba79b9f4916c30db74fe65508dca033">type::get_by_name</a>(<span class="stringliteral">&quot;MyPluginClass&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// iterate over all methods of the class</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> meth : t.get_methods())</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; meth.get_signature() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// work with the new type</span></div>
<div class="line">    <span class="keyword">auto</span> var = t.create();</div>
<div class="line">    t.invoke(<span class="stringliteral">&quot;perform_calculation&quot;</span>, var, {});</div>
<div class="line">    std::cout &lt;&lt; t.get_property_value(<span class="stringliteral">&quot;value&quot;</span>, var).to_int() &lt;&lt; std::endl; <span class="comment">// prints &quot;12&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Output: </p><div class="fragment"><div class="line">MyPluginClass</div>
<div class="line">perform_calculation( )</div>
<div class="line">perform_calculation( <span class="keywordtype">int</span> )</div>
<div class="line">12</div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>When you compile your plugin with the <code>gcc</code> toolchain, make sure you use the compiler option: <code>-fno-gnu-unique</code>. otherwise the unregistration will not work properly.</dd></dl>
<h1><a class="anchor" id="autotoc_md83"></a>
Summary</h1>
<ul>
<li>Using plugins you can work with types without having access to the concrete type itself</li>
<li>You don't have to explicit export (e.g. using <code>__declspec( dllexport )</code>) your types in the shared library</li>
<li>You can export classes, without a generic abstract interface</li>
<li>You can export overloaded methods (not possible in C)</li>
<li>With all this functionality, it is easily possible to implement <b>hot-reload</b> of shared libraries. You could serialize your object into JSON-Format, unload the library, load the new version and deserialize it again.</li>
<li><dl class="section remark"><dt>Remarks</dt><dd>Make sure you throw away all retrieved items (<a class="el" href="classrttr_1_1type.html">types</a>, <a class="el" href="classrttr_1_1property.html">properties</a>, <a class="el" href="classrttr_1_1method.html">methods</a> etc...) of the loaded library when unloading. Otherwise UB may occur. (e.g. Invoking a method of an unloaded library is not possible) When you want to create dynamic plugins with RTTR, make sure you link dynamically against the host application and the plugin, otherwise you will get UB. Also see <code>/src/examples/library_loading</code> for example of hot reloading.</dd></dl>
<hr  />
</li>
</ul>
<div type="button" class="btn btn-default doxy-button"><a class="el" href="register_policies_page.html">previous</a></div><div class="btn btn-default doxy-button"><a class="el" href="tutorial_page.html">finished</a></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aclassrttr_1_1registration_1_1class___html_a0c0f9b9b4a78e8eefb17f690f15e7795"><div class="ttname"><a href="classrttr_1_1registration_1_1class__.html#a0c0f9b9b4a78e8eefb17f690f15e7795">rttr::registration::class_::constructor</a></div><div class="ttdeci">bind&lt; detail::ctor, Class_Type, acc_level, Visitor_List, Args... &gt; constructor(acc_level level=acc_level())</div><div class="ttdoc">Register a constructor for this class type with or without arguments.</div></div>
<div class="ttc" id="anamespacerttr_html"><div class="ttname"><a href="namespacerttr.html">rttr</a></div><div class="ttdef"><b>Definition:</b> access_levels.h:33</div></div>
<div class="ttc" id="anamespacerttr_html_a54ecd8bad715cbc451e7aa8491667d4a"><div class="ttname"><a href="namespacerttr.html#a54ecd8bad715cbc451e7aa8491667d4a">rttr::value</a></div><div class="ttdeci">detail::enum_data&lt; Enum_Type &gt; value(string_view, Enum_Type value)</div><div class="ttdoc">The value function should be used to add a mapping from enum name to value during the registration pr...</div></div>
<div class="ttc" id="aclassrttr_1_1registration_1_1class___html"><div class="ttname"><a href="classrttr_1_1registration_1_1class__.html">rttr::registration::class_</a></div><div class="ttdoc">The class_ is used to register classes to RTTR.</div><div class="ttdef"><b>Definition:</b> registration.h:154</div></div>
<div class="ttc" id="anamespacerttr_html_a1582d7d5b803f7dd5498a4a0166d382d"><div class="ttname"><a href="namespacerttr.html#a1582d7d5b803f7dd5498a4a0166d382d">rttr::select_overload</a></div><div class="ttdeci">Signature * select_overload(Signature *func)</div><div class="ttdoc">This is a helper function to register overloaded functions.</div><div class="ttdef"><b>Definition:</b> registration.h:506</div></div>
<div class="ttc" id="aclassrttr_1_1library_html"><div class="ttname"><a href="classrttr_1_1library.html">rttr::library</a></div><div class="ttdoc">The library class provides a cross platform way of explicit loading shared objects (....</div><div class="ttdef"><b>Definition:</b> library.h:124</div></div>
<div class="ttc" id="aregistration_8h_html_acd4d632edb955a7664489ae6d90aa8bd"><div class="ttname"><a href="registration_8h.html#acd4d632edb955a7664489ae6d90aa8bd">RTTR_PLUGIN_REGISTRATION</a></div><div class="ttdeci">#define RTTR_PLUGIN_REGISTRATION</div><div class="ttdoc">Use this macro to automatically register your reflection information inside a plugin to RTTR.</div><div class="ttdef"><b>Definition:</b> registration.h:794</div></div>
<div class="ttc" id="aclassrttr_1_1type_html_a7ba79b9f4916c30db74fe65508dca033"><div class="ttname"><a href="classrttr_1_1type.html#a7ba79b9f4916c30db74fe65508dca033">rttr::type::get_by_name</a></div><div class="ttdeci">static type get_by_name(string_view name) noexcept</div><div class="ttdoc">Returns the type object with the given name name.</div></div>
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/>
<address class="footer">
<small>
Generated on Wed Mar 4 2020 09:24:05 for rttr - 0.9.7 by 
<a href="http://www.doxygen.org/index.html">doxygen</a>.
</small>
</address>
</body>
</html>
